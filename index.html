<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Cotizaciones - Noticias</title>
<style>
:root {
    --color-primary: #005baa;
    --color-text-dark: #2c3e50;
    --color-background-light: #f9f9f9;
    --shadow-base: 0 0 15px rgba(0,0,0,0.1);
    --shadow-hover: 0 12px 32px rgba(0,0,0,0.15);
}
body {
    font-family: Arial, sans-serif;
    margin: 0;
    background: var(--color-background-light);
    color: var(--color-text-dark);
}
header {
    background-color: var(--color-primary);
    color: white;
    padding: 20px;
    text-align: center;
}
header h1 { margin:0; font-size: 2rem; }
nav a {
    color: white;
    margin: 0 15px;
    text-decoration: none;
    font-weight: bold;
}
nav a:hover { text-decoration: underline; }
main {
    max-width: 900px;
    margin: 30px auto;
    text-align: center;
}
.section-card {
    background: white;
    border-radius: 10px;
    padding: 25px;
    margin-bottom: 30px;
    box-shadow: var(--shadow-base);
}
#acciones-barra-superior { display: flex; justify-content: center; align-items: center; }
#noticias-lista { list-style:none; padding:0; text-align:left; }
#noticias-lista li { margin-bottom:15px; }
</style>
</head>
<body>

<header>
    <h1>Cotizaciones - Noticias</h1>
    <nav>
        <a href="index.html">Inicio</a>
        <a href="cuit-cuil.html">CUIT/CUIL</a>
        <a href="validador.html">Validador CBU/CVU</a>
        <a href="contacto.html">Contacto</a>
    </nav>
</header>

<main>
    <!-- Cotizaciones de Acciones -->
    <section id="acciones-barra-superior" class="section-card">
        <h2>Cotizaciones de Acciones</h2>
        <div class="tradingview-widget-container">
            <div id="tradingview-ticker"></div>
            <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js" async>
            {
                "symbols":[
                    {"proName":"BCBA:GGAL","title":"GGAL"},
                    {"proName":"BCBA:YPFD","title":"YPFD"},
                    {"proName":"BCBA:PAMP","title":"PAMP"},
                    {"proName":"BCBA:COME","title":"COME"},
                    {"proName":"BCBA:CEPU","title":"CEPU"},
                    {"proName":"BCBA:BMA","title":"BMA"},
                    {"proName":"BCBA:TECO2","title":"TECO2"}
                ],
                "colorTheme":"light",
                "isTransparent":false,
                "displayMode":"adaptive",
                "locale":"es"
            }
            </script>
        </div>
    </section>

    <!-- Cotizaciones del Dólar -->
    <section id="cotizaciones-dolar" class="section-card">
        <h2>Cotizaciones del Dólar</h2>
        <div id="dolar-cotizaciones">Cargando cotizaciones...</div>
    </section>

    <!-- Noticias -->
    <section id="noticias" class="section-card">
        <h2>Noticias Económicas - Varias Fuentes</h2>
        <ul id="noticias-lista"><li>Cargando noticias...</li></ul>
    </section>
</main>

<script>
// Cotizaciones de Dólar
async function cargarCotizaciones() {
    const target = document.getElementById('dolar-cotizaciones');
    try {
        const res = await fetch('https://api.bluelytics.com.ar/v2/latest');
        if(!res.ok) throw new Error("API no responde");
        const data = await res.json();
        target.innerHTML = `
            <p><strong>Dólar Blue:</strong> Compra $${data.blue.value_buy.toFixed(2)} - Venta $${data.blue.value_sell.toFixed(2)}</p>
            <p><strong>Dólar Oficial:</strong> Compra $${data.oficial.value_buy.toFixed(2)} - Venta $${data.oficial.value_sell.toFixed(2)}</p>
            <p style="font-size:12px;color:#666;">Última actualización: ${new Date().toLocaleString('es-AR')}</p>
        `;
    } catch(e) {
        target.textContent = "Error al cargar cotizaciones.";
        console.error(e);
    }
}
cargarCotizaciones();
setInterval(cargarCotizaciones,60000);

// Noticias
async function cargarNoticias() {
    const noticiasLista = document.getElementById('noticias-lista');
    const proxy = 'https://api.allorigins.win/get?url=';
    const feeds = [
        'https://www.ambito.com/rss/economia.xml',
        'https://www.lanacion.com.ar/arc/outboundfeeds/rss/economia/',
        'https://www.clarin.com/rss/economia/'
    ];
    try {
        let itemsAll = [];
        for(const url of feeds){
            const res = await fetch(proxy + encodeURIComponent(url));
            if(!res.ok) continue;
            const data = await res.json();
            const parser = new DOMParser();
            const xml = parser.parseFromString(data.contents,"text/xml");
            const items = xml.querySelectorAll('item');
            items.forEach((item,i)=>{
                if(i>=5) return;
                const title = item.querySelector('title')?.textContent || '';
                const link = item.querySelector('link')?.textContent || '#';
                itemsAll.push({title,link});
            });
        }
        if(itemsAll.length === 0) noticiasLista.innerHTML = '<li>No se pudieron cargar noticias.</li>';
        else noticiasLista.innerHTML = itemsAll.map(n=>`<li><a href="${n.link}" target="_blank">${n.title}</a></li>`).join('');
    } catch(e) {
        noticiasLista.innerHTML = '<li>Error al cargar noticias.</li>';
        console.error(e);
    }
}
cargarNoticias();
setInterval(cargarNoticias,300000);
</script>
</body>
</html>

