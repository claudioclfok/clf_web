<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Calculadora RCI y Consulta Directa</title>
<style>
    body { font-family: 'Segoe UI', Arial, sans-serif; background: #f0f2f5; color: #333; margin: 0; padding: 20px; }
    .container { max-width: 950px; margin: auto; background: #fff; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
    h2, h3 { color: #004a99; border-bottom: 2px solid #eee; padding-bottom: 10px; margin-top: 30px; }
    .seccion-libre { background: #e8eff7; padding: 15px; border-radius: 8px; border-left: 5px solid #004a99; margin-top: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; background: #fff; }
    th, td { border: 1px solid #e0e0e0; padding: 10px; text-align: right; }
    th { background: #004a99; color: white; text-align: center; }
    input, select { width: 94%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 16px; }
    .resaltar { font-size: 1.2em; color: #28a745; font-weight: bold; }
    .analisis { background: #f8d7da; color: #721c24; font-weight: bold; text-align: center; padding: 20px; border-radius: 8px; margin-top: 20px; }
    .grid-directa { display: flex; align-items: center; gap: 20px; margin-top: 10px; }
    .left { text-align: left; font-weight: 500; background: #fdfdfd; }
</style>
</head>
<body>

<div class="container">
    <h2>Sistema de Evaluación de Créditos</h2>

    <h3>1. Evaluación por RCI (Filtro Automático)</h3>
    <table>
        <tr><td class="left">Sueldo Neto</td><td><input type="number" id="sueldo" oninput="calcularTodo()"></td></tr>
        <tr><td class="left">Total Deuda BCRA (Situaciones 1 a 5)</td><td><input type="number" id="deudaBCRA" oninput="calcularTodo()" placeholder="Suma total de situaciones"></td></tr>
    </table>

    <table>
        <tr><td class="left">Cant. Sueldos Adeudados: <span id="endeudamiento">0</span></td><td class="left">RCI: <span id="rci">-</span></td><td class="resaltar">Cuota Máx: <span id="cuotaMax">$ 0</span></td></tr>
    </table>

    <div id="mensajeRiesgo"></div>

    <div id="seccionRCI">
        <h3>Monto otorgable por RCI</h3>
        <table id="tablaRCI">
            <thead>
                <tr><th>Capital</th><th>Plazo</th><th>Valor Cuota</th></tr>
            </thead>
            <tbody id="resRCI"></tbody>
        </table>
    </div>

    <div class="seccion-libre">
        <h3>2. Consulta Directa por Monto (Sin contar RCI)</h3>
        <p>Seleccione o ingrese un capital para ver todas sus cuotas disponibles:</p>
        <div class="grid-directa">
            <input type="number" id="montoLibre" placeholder="Ej: 800000" oninput="consultarDirecto()">
        </div>
        
        <table id="tablaLibre" style="display:none;">
            <thead>
                <tr><th style="background:#444">Capital</th><th style="background:#444">Plazo (Meses)</th><th style="background:#444">Cuota Mensual</th></tr>
            </thead>
            <tbody id="resLibre"></tbody>
        </table>
    </div>
</div>

<script>
// Grilla Completa
const grilla = [
    {cap: 1000000, c: 36, v: 234039.97}, {cap: 1000000, c: 24, v: 243343.46}, {cap: 1000000, c: 18, v: 259616.01}, {cap: 1000000, c: 12, v: 279430.77},
    {cap: 950000, c: 36, v: 222337.97}, {cap: 950000, c: 24, v: 231176.28}, {cap: 950000, c: 18, v: 246635.21}, {cap: 950000, c: 12, v: 265459.23},
    {cap: 900000, c: 36, v: 210635.97}, {cap: 900000, c: 24, v: 219009.11}, {cap: 900000, c: 18, v: 233654.41}, {cap: 900000, c: 12, v: 251487.70},
    {cap: 850000, c: 36, v: 198933.97}, {cap: 850000, c: 24, v: 206841.94}, {cap: 850000, c: 18, v: 220673.61}, {cap: 850000, c: 12, v: 237516.16},
    {cap: 800000, c: 36, v: 187231.97}, {cap: 800000, c: 24, v: 194674.76}, {cap: 800000, c: 18, v: 207692.81}, {cap: 800000, c: 12, v: 223544.62},
    {cap: 750000, c: 36, v: 175529.97}, {cap: 750000, c: 24, v: 182507.59}, {cap: 750000, c: 18, v: 194712.01}, {cap: 750000, c: 12, v: 209573.08}, {cap: 750000, c: 6, v: 296047.57},
    {cap: 700000, c: 36, v: 163827.98}, {cap: 700000, c: 24, v: 170340.42}, {cap: 700000, c: 18, v: 181731.21}, {cap: 700000, c: 12, v: 195601.54}, {cap: 700000, c: 6, v: 276311.07},
    {cap: 650000, c: 36, v: 152125.98}, {cap: 650000, c: 24, v: 158173.25}, {cap: 650000, c: 18, v: 168750.41}, {cap: 650000, c: 12, v: 181630.00}, {cap: 650000, c: 6, v: 256574.56},
    {cap: 600000, c: 36, v: 140423.98}, {cap: 600000, c: 24, v: 146006.07}, {cap: 600000, c: 18, v: 155769.61}, {cap: 600000, c: 12, v: 167658.46}, {cap: 600000, c: 6, v: 236838.06},
    {cap: 550000, c: 36, v: 128721.98}, {cap: 550000, c: 24, v: 133838.90}, {cap: 550000, c: 18, v: 142788.81}, {cap: 550000, c: 12, v: 153686.93}, {cap: 550000, c: 6, v: 217101.55},
    {cap: 500000, c: 36, v: 117019.98}, {cap: 500000, c: 24, v: 121671.73}, {cap: 500000, c: 18, v: 129808.01}, {cap: 500000, c: 12, v: 139715.39}, {cap: 500000, c: 6, v: 197365.05},
    {cap: 400000, c: 36, v: 93615.99},  {cap: 400000, c: 12, v: 111772.31}, {cap: 400000, c: 6, v: 157892.04},
    {cap: 300000, c: 36, v: 70211.99},  {cap: 300000, c: 12, v: 83829.23},  {cap: 300000, c: 6, v: 118419.03},
    {cap: 200000, c: 36, v: 46807.99},  {cap: 200000, c: 12, v: 55886.15},  {cap: 200000, c: 6, v: 78946.02},
    {cap: 100000, c: 36, v: 23404.00},  {cap: 100000, c: 12, v: 27943.08},  {cap: 100000, c: 6, v: 39473.01}
];

function calcularTodo() {
    const sueldo = Number(document.getElementById("sueldo").value) || 0;
    const deuda = Number(document.getElementById("deudaBCRA").value) || 0;
    const ratio = sueldo > 0 ? deuda / sueldo : 0;
    
    document.getElementById("endeudamiento").innerText = ratio.toFixed(2);
    
    let rci = 0;
    let cuotaMax = 0;
    const mensaje = document.getElementById("mensajeRiesgo");
    const secRCI = document.getElementById("seccionRCI");

    if (sueldo > 0) {
        if (ratio <= 10) rci = 0.15;
        else if (ratio <= 15) rci = 0.10;
        
        if (ratio > 15) {
            document.getElementById("rci").innerText = "RIESGO";
            document.getElementById("cuotaMax").innerText = "BLOQUEADO";
            mensaje.innerHTML = "<div class='analisis'>⚠️ EXCESO O DEUDA: Supera 15 sueldos.</div>";
            secRCI.style.display = "none";
        } else {
            document.getElementById("rci").innerText = (rci * 100) + "%";
            cuotaMax = sueldo * rci;
            document.getElementById("cuotaMax").innerText = "$ " + cuotaMax.toLocaleString();
            mensaje.innerHTML = "";
            secRCI.style.display = "block";
            
            // Llenar tabla RCI
            const resRCI = document.getElementById("resRCI");
            resRCI.innerHTML = "";
            grilla.forEach(i => {
                if (i.v <= cuotaMax) {
                    resRCI.innerHTML += `<tr><td>$ ${i.cap.toLocaleString()}</td><td>${i.c} meses</td><td>$ ${i.v.toLocaleString()}</td></tr>`;
                }
            });
        }
    }
}

function consultarDirecto() {
    const monto = Number(document.getElementById("montoLibre").value);
    const tabla = document.getElementById("tablaLibre");
    const res = document.getElementById("resLibre");
    res.innerHTML = "";

    if (monto > 0) {
        const opciones = grilla.filter(i => i.cap === monto);
        if (opciones.length > 0) {
            tabla.style.display = "table";
            opciones.forEach(o => {
                res.innerHTML += `<tr><td>$ ${o.cap.toLocaleString()}</td><td>${o.c} meses</td><td style="font-weight:bold">$ ${o.v.toLocaleString()}</td></tr>`;
            });
        } else {
            tabla.style.display = "none";
        }
    } else {
        tabla.style.display = "none";
    }
}
</script>
</body>
</html>
